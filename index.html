<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar System Sizer PWA</title>
    <meta name="description" content="Professional solar system sizing calculator">
    <meta name="theme-color" content="#FF9800">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- iOS Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Solar Sizer">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    
    <!-- Favicon -->
    <link rel="icon" href="icons/icon-192.png">
    
    <!-- CSS -->
    <link rel="stylesheet" href="style.css">
    
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>
    <!-- PWA Installation Prompt -->
    <div id="installPrompt" class="install-prompt">
        <div class="install-content">
            <span>üì± Install Solar Sizer for offline use</span>
            <div>
                <button id="installCancel" class="btn-secondary">Not Now</button>
                <button id="installButton" class="btn-primary">Install</button>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div class="container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <h1><span class="material-icons">solar_power</span> Solar System Sizer</h1>
                <div class="header-actions">
                    <button id="saveProject" class="icon-btn" title="Save Project">
                        <span class="material-icons">save</span>
                    </button>
                    <button id="loadProject" class="icon-btn" title="Load Project">
                        <span class="material-icons">folder_open</span>
                    </button>
                    <button id="exportPDF" class="icon-btn" title="Export PDF">
                        <span class="material-icons">picture_as_pdf</span>
                    </button>
                    <button id="themeToggle" class="icon-btn" title="Toggle Theme">
                        <span class="material-icons">dark_mode</span>
                    </button>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-step active" data-step="1">Loads</div>
                <div class="progress-step" data-step="2">Battery</div>
                <div class="progress-step" data-step="3">Solar</div>
                <div class="progress-step" data-step="4">Results</div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Step 1: Load Calculator -->
            <section id="step1" class="step active">
                <div class="card">
                    <h2><span class="material-icons">calculate</span> Load Calculator</h2>
                    <p class="card-subtitle">Enter your appliances to calculate daily energy consumption</p>
                    
                    <div class="quick-add">
                        <h3>Quick Add Appliances</h3>
                        <div class="quick-buttons">
                            <button class="btn-chip" data-appliance='{"name":"LED Light","power":10,"type":"DC","hours":6}'>
                                üí° LED Light
                            </button>
                            <button class="btn-chip" data-appliance='{"name":"Refrigerator","power":150,"type":"AC","hours":24}'>
                                üßä Refrigerator
                            </button>
                            <button class="btn-chip" data-appliance='{"name":"TV","power":120,"type":"AC","hours":3}'>
                                üì∫ TV
                            </button>
                            <button class="btn-chip" data-appliance='{"name":"Laptop","power":65,"type":"AC","hours":4}'>
                                üíª Laptop
                            </button>
                            <button class="btn-chip" data-appliance='{"name":"AC Unit","power":1000,"type":"AC","hours":4}'>
                                ‚ùÑÔ∏è AC Unit
                            </button>
                            <button class="btn-chip" data-appliance='{"name":"Water Pump","power":500,"type":"AC","hours":1}'>
                                üíß Water Pump
                            </button>
                        </div>
                    </div>
                    
                    <div class="appliance-list">
                        <h3>Appliance List</h3>
                        <table id="applianceTable">
                            <thead>
                                <tr>
                                    <th>Appliance</th>
                                    <th>Type</th>
                                    <th>Power (W)</th>
                                    <th>Qty</th>
                                    <th>Hours</th>
                                    <th>Daily Energy</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="applianceTableBody">
                                <!-- Rows will be added here dynamically -->
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="5" style="text-align: right; font-weight: bold;">Total Daily Energy:</td>
                                    <td id="totalEnergy">0 Wh</td>
                                    <td></td>
                                </tr>
                            </tfoot>
                        </table>
                        
                        <button id="addCustomAppliance" class="btn-outline">
                            <span class="material-icons">add</span> Add Custom Appliance
                        </button>
                    </div>
                    
                    <div class="energy-summary">
                        <div class="summary-card">
                            <div class="summary-icon">‚ö°</div>
                            <div class="summary-content">
                                <h4>DC Loads</h4>
                                <p id="dcLoads">0 Wh</p>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-icon">üîå</div>
                            <div class="summary-content">
                                <h4>AC Loads</h4>
                                <p id="acLoads">0 Wh</p>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-icon">üìä</div>
                            <div class="summary-content">
                                <h4>Total Energy</h4>
                                <p id="totalEnergyDisplay">0 Wh</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="step-actions">
                        <button id="nextToStep2" class="btn-primary">
                            Next: Battery Sizing <span class="material-icons">arrow_forward</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Step 2: Battery Sizing -->
            <section id="step2" class="step">
                <div class="card">
                    <h2><span class="material-icons">battery_charging_full</span> Battery Sizing</h2>
                    <p class="card-subtitle">Configure your battery bank requirements</p>
                    
                    <div class="parameter-grid">
                        <div class="param-group">
                            <label for="systemVoltage">
                                <span class="material-icons">bolt</span> System Voltage
                            </label>
                            <select id="systemVoltage" class="form-select">
                                <option value="12">12V</option>
                                <option value="24" selected>24V</option>
                                <option value="48">48V</option>
                            </select>
                        </div>
                        
                        <div class="param-group">
                            <label for="autonomyDays">
                                <span class="material-icons">calendar_today</span> Days of Autonomy
                            </label>
                            <input type="number" id="autonomyDays" class="form-input" value="5" min="1" max="30">
                            <span class="unit">days</span>
                        </div>
                        
                        <div class="param-group">
                            <label for="depthOfDischarge">
                                <span class="material-icons">battery_alert</span> Depth of Discharge (DoD)
                            </label>
                            <div class="slider-container">
                                <input type="range" id="depthOfDischarge" min="30" max="100" value="70" class="slider">
                                <span id="dodValue">70%</span>
                            </div>
                        </div>
                        
                        <div class="param-group">
                            <label for="batteryType">
                                <span class="material-icons">battery_std</span> Battery Type
                            </label>
                            <select id="batteryType" class="form-select">
                                <option value="lifepo4">LiFePO4 (Recommended)</option>
                                <option value="lithium">Lithium-ion</option>
                                <option value="leadacid">Lead-Acid</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="battery-result">
                        <h3>Battery Bank Calculation</h3>
                        <div class="calculation-steps">
                            <div class="calc-step">
                                <span class="calc-label">Daily Ah Required:</span>
                                <span class="calc-value" id="dailyAh">0 Ah</span>
                            </div>
                            <div class="calc-step">
                                <span class="calc-label">For <span id="autonomyDaysValue">5</span> days autonomy:</span>
                                <span class="calc-value" id="autonomyAh">0 Ah</span>
                            </div>
                            <div class="calc-step">
                                <span class="calc-label">At <span id="dodPercent">70%</span> DoD:</span>
                                <span class="calc-value" id="dodAh">0 Ah</span>
                            </div>
                            <div class="calc-step highlight">
                                <span class="calc-label"><strong>Minimum Battery Bank:</strong></span>
                                <span class="calc-value" id="minBattery">0 Ah</span>
                            </div>
                            <div class="calc-step">
                                <span class="calc-label">Recommended Size:</span>
                                <span class="calc-value" id="recBattery">0 Ah</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="battery-comparison">
                        <h3>Battery Type Comparison</h3>
                        <div class="comparison-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Type</th>
                                        <th>DoD</th>
                                        <th>Life Cycles</th>
                                        <th>Cost/kWh</th>
                                        <th>Recommendation</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>LiFePO4</td>
                                        <td>80-100%</td>
                                        <td>3000-6000</td>
                                        <td>$300</td>
                                        <td><span class="badge success">‚úì Recommended</span></td>
                                    </tr>
                                    <tr>
                                        <td>Lithium-ion</td>
                                        <td>80-95%</td>
                                        <td>2000-4000</td>
                                        <td>$250</td>
                                        <td><span class="badge">Good</span></td>
                                    </tr>
                                    <tr>
                                        <td>Lead-Acid</td>
                                        <td>30-50%</td>
                                        <td>300-800</td>
                                        <td>$100</td>
                                        <td><span class="badge warning">Small systems only</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="step-actions">
                        <button id="backToStep1" class="btn-secondary">
                            <span class="material-icons">arrow_back</span> Back
                        </button>
                        <button id="nextToStep3" class="btn-primary">
                            Next: Solar Array <span class="material-icons">arrow_forward</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Step 3: Solar Array Sizing -->
            <section id="step3" class="step">
                <div class="card">
                    <h2><span class="material-icons">wb_sunny</span> Solar Array Sizing</h2>
                    <p class="card-subtitle">Configure your PV system based on location and panels</p>
                    
                    <div class="parameter-grid">
                        <div class="param-group">
                            <label for="peakSunHours">
                                <span class="material-icons">light_mode</span> Peak Sun Hours (PSH)
                            </label>
                            <input type="number" id="peakSunHours" class="form-input" value="4.5" min="1" max="8" step="0.1">
                            <span class="unit">hours</span>
                            <div class="location-selector">
                                <select id="locationSelect" class="form-select">
                                    <option value="">Select Location</option>
                                    <option value="tropical">üå¥ Tropical (5-6 PSH)</option>
                                    <option value="subtropical">‚òÄÔ∏è Subtropical (4.5-5.5 PSH)</option>
                                    <option value="temperate">üå§Ô∏è Temperate (3.5-4.5 PSH)</option>
                                    <option value="northern">‚ùÑÔ∏è Northern (2.5-3.5 PSH)</option>
                                </select>
                                <button id="useGPS" class="btn-small">
                                    <span class="material-icons">my_location</span> Use GPS
                                </button>
                            </div>
                        </div>
                        
                        <div class="param-group">
                            <label for="panelType">
                                <span class="material-icons">grid_4x4</span> Solar Panel Type
                            </label>
                            <select id="panelType" class="form-select">
                                <option value="mono">Monocrystalline (18-22% efficiency)</option>
                                <option value="poly">Polycrystalline (15-17% efficiency)</option>
                                <option value="thin">Thin Film (7-13% efficiency)</option>
                            </select>
                        </div>
                        
                        <div class="param-group">
                            <label for="panelWattage">
                                <span class="material-icons">flash_on</span> Panel Wattage
                            </label>
                            <select id="panelWattage" class="form-select">
                                <option value="300">300W</option>
                                <option value="400" selected>400W</option>
                                <option value="550">550W</option>
                                <option value="600">600W</option>
                            </select>
                        </div>
                        
                        <div class="param-group">
                            <label for="deratingFactor">
                                <span class="material-icons">warning</span> System Losses
                            </label>
                            <div class="slider-container">
                                <input type="range" id="deratingFactor" min="70" max="95" value="85" class="slider">
                                <span id="deratingValue">85%</span>
                            </div>
                            <small class="hint">Dirt, wiring, temperature, inverter losses</small>
                        </div>
                    </div>
                    
                    <div class="solar-result">
                        <h3>PV Array Calculation</h3>
                        <div class="calculation-steps">
                            <div class="calc-step">
                                <span class="calc-label">Daily PV Energy Required:</span>
                                <span class="calc-value" id="dailyPVEnergy">0 Wh</span>
                            </div>
                            <div class="calc-step">
                                <span class="calc-label">At <span id="pshValue">4.5</span> PSH:</span>
                                <span class="calc-value" id="arrayPower">0 W</span>
                            </div>
                            <div class="calc-step">
                                <span class="calc-label">With <span id="deratingPercent">85%</span> efficiency:</span>
                                <span class="calc-value" id="arrayPowerAdj">0 W</span>
                            </div>
                            <div class="calc-step">
                                <span class="calc-label">Using <span id="panelWattageValue">400</span>W panels:</span>
                                <span class="calc-value" id="panelCount">0 panels</span>
                            </div>
                            <div class="calc-step highlight">
                                <span class="calc-label"><strong>Array Configuration:</strong></span>
                                <span class="calc-value" id="arrayConfig">0S √ó 0P</span>
                            </div>
                            <div class="calc-step highlight">
                                <span class="calc-label"><strong>Total Array Power:</strong></span>
                                <span class="calc-value" id="totalArrayPower">0 W</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="panel-comparison">
                        <h3>Panel Type Comparison</h3>
                        <div class="comparison-cards">
                            <div class="comparison-card">
                                <div class="comparison-header mono">
                                    <span class="material-icons">check_circle</span>
                                    <h4>Monocrystalline</h4>
                                </div>
                                <ul>
                                    <li>Efficiency: 18-22%</li>
                                    <li>Lifespan: 25+ years</li>
                                    <li>Space: Most efficient</li>
                                    <li>Cost: Highest</li>
                                </ul>
                            </div>
                            <div class="comparison-card">
                                <div class="comparison-header poly">
                                    <span class="material-icons">info</span>
                                    <h4>Polycrystalline</h4>
                                </div>
                                <ul>
                                    <li>Efficiency: 15-17%</li>
                                    <li>Lifespan: 20-25 years</li>
                                    <li>Space: Moderate</li>
                                    <li>Cost: Medium</li>
                                </ul>
                            </div>
                            <div class="comparison-card">
                                <div class="comparison-header thin">
                                    <span class="material-icons">warning</span>
                                    <h4>Thin Film</h4>
                                </div>
                                <ul>
                                    <li>Efficiency: 7-13%</li>
                                    <li>Lifespan: 10-20 years</li>
                                    <li>Space: Least efficient</li>
                                    <li>Cost: Lowest</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="step-actions">
                        <button id="backToStep2" class="btn-secondary">
                            <span class="material-icons">arrow_back</span> Back
                        </button>
                        <button id="nextToStep4" class="btn-primary">
                            Next: Results & Cost <span class="material-icons">arrow_forward</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Step 4: Results -->
            <section id="step4" class="step">
                <div class="card">
                    <h2><span class="material-icons">summarize</span> System Design Summary</h2>
                    <p class="card-subtitle">Complete system design with component selection and cost estimation</p>
                    
                    <div class="summary-overview">
                        <div class="overview-cards">
                            <div class="overview-card">
                                <div class="overview-icon energy">‚ö°</div>
                                <div class="overview-content">
                                    <h4>Daily Energy</h4>
                                    <p id="summaryEnergy">0 Wh</p>
                                </div>
                            </div>
                            <div class="overview-card">
                                <div class="overview-icon battery">üîã</div>
                                <div class="overview-content">
                                    <h4>Battery Bank</h4>
                                    <p id="summaryBattery">0 Ah</p>
                                </div>
                            </div>
                            <div class="overview-card">
                                <div class="overview-icon solar">‚òÄÔ∏è</div>
                                <div class="overview-content">
                                    <h4>PV Array</h4>
                                    <p id="summaryPV">0 W</p>
                                </div>
                            </div>
                            <div class="overview-card">
                                <div class="overview-icon cost">üí∞</div>
                                <div class="overview-content">
                                    <h4>Estimated Cost</h4>
                                    <p id="summaryCost">$0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="system-diagram">
                        <h3>System Diagram</h3>
                        <div class="diagram">
                            <div class="diagram-component solar-array">
                                <span class="material-icons">solar_power</span>
                                <span>Solar Array</span>
                            </div>
                            <div class="diagram-arrow">‚Üí</div>
                            <div class="diagram-component charge-controller">
                                <span class="material-icons">tune</span>
                                <span>MPPT Charge Controller</span>
                            </div>
                            <div class="diagram-arrow">‚Üí</div>
                            <div class="diagram-component battery-bank">
                                <span class="material-icons">battery_charging_full</span>
                                <span>Battery Bank</span>
                            </div>
                            <div class="diagram-arrow">‚Üí</div>
                            <div class="diagram-component inverter">
                                <span class="material-icons">power</span>
                                <span>Inverter</span>
                            </div>
                            <div class="diagram-branch">
                                <div class="branch-arrow">‚Üì</div>
                                <div class="diagram-component ac-loads">
                                    <span class="material-icons">outlet</span>
                                    <span>AC Loads</span>
                                </div>
                            </div>
                            <div class="diagram-branch">
                                <div class="branch-arrow">‚Üì</div>
                                <div class="diagram-component dc-loads">
                                    <span class="material-icons">usb</span>
                                    <span>DC Loads</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="component-details">
                        <h3>Component Specifications</h3>
                        <div class="details-grid">
                            <div class="detail-card">
                                <h4><span class="material-icons">solar_power</span> PV Array</h4>
                                <ul>
                                    <li>Power: <span id="detailPVPower">0 W</span></li>
                                    <li>Panels: <span id="detailPanelCount">0</span> √ó <span id="detailPanelWattage">400W</span></li>
                                    <li>Configuration: <span id="detailArrayConfig">0S √ó 0P</span></li>
                                    <li>Daily Production: <span id="detailDailyProd">0 Wh</span></li>
                                </ul>
                            </div>
                            <div class="detail-card">
                                <h4><span class="material-icons">battery_charging_full</span> Battery Bank</h4>
                                <ul>
                                    <li>Capacity: <span id="detailBatteryAh">0 Ah</span> at <span id="detailVoltage">24V</span></li>
                                    <li>Type: <span id="detailBatteryType">LiFePO4</span></li>
                                    <li>Days Autonomy: <span id="detailAutonomy">5</span></li>
                                    <li>DoD: <span id="detailDoD">70%</span></li>
                                </ul>
                            </div>
                            <div class="detail-card">
                                <h4><span class="material-icons">power</span> Inverter</h4>
                                <ul>
                                    <li>Size: <span id="detailInverterSize">0 VA</span></li>
                                    <li>Type: Pure Sine Wave</li>
                                    <li>Efficiency: 92-96%</li>
                                    <li>Surge: <span id="detailInverterSurge">0 VA</span></li>
                                </ul>
                            </div>
                            <div class="detail-card">
                                <h4><span class="material-icons">tune</span> Charge Controller</h4>
                                <ul>
                                    <li>Type: MPPT</li>
                                    <li>Current: <span id="detailControllerCurrent">0 A</span></li>
                                    <li>Voltage: <span id="detailControllerVoltage">0 V</span></li>
                                    <li>Efficiency: 98%</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="cost-estimation">
                        <h3>Cost Estimation</h3>
                        <div class="cost-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Component</th>
                                        <th>Quantity</th>
                                        <th>Unit Cost</th>
                                        <th>Total</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Solar Panels</td>
                                        <td id="costPanelsQty">0</td>
                                        <td>$<span id="costPanelUnit">0.50</span>/W</td>
                                        <td id="costPanelsTotal">$0</td>
                                    </tr>
                                    <tr>
                                        <td>Batteries</td>
                                        <td id="costBatteryQty">0 kWh</td>
                                        <td>$<span id="costBatteryUnit">300</span>/kWh</td>
                                        <td id="costBatteryTotal">$0</td>
                                    </tr>
                                    <tr>
                                        <td>Inverter</td>
                                        <td>1</td>
                                        <td>$<span id="costInverterUnit">0.30</span>/W</td>
                                        <td id="costInverterTotal">$0</td>
                                    </tr>
                                    <tr>
                                        <td>Charge Controller</td>
                                        <td>1</td>
                                        <td>$<span id="costControllerUnit">5</span>/A</td>
                                        <td id="costControllerTotal">$0</td>
                                    </tr>
                                    <tr>
                                        <td>Mounting & Wiring</td>
                                        <td>-</td>
                                        <td>20% of hardware</td>
                                        <td id="costMounting">$0</td>
                                    </tr>
                                    <tr class="total-row">
                                        <td colspan="3"><strong>Total System Cost</strong></td>
                                        <td id="costSystemTotal"><strong>$0</strong></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="roi-calculator">
                            <h4>Return on Investment (ROI)</h4>
                            <div class="roi-grid">
                                <div class="roi-input">
                                    <label for="electricityRate">Electricity Rate ($/kWh)</label>
                                    <input type="number" id="electricityRate" value="0.15" step="0.01" min="0.05" max="1">
                                </div>
                                <div class="roi-result">
                                    <div class="roi-metric">
                                        <span class="roi-label">Monthly Savings:</span>
                                        <span class="roi-value" id="monthlySavings">$0</span>
                                    </div>
                                    <div class="roi-metric">
                                        <span class="roi-label">Annual Savings:</span>
                                        <span class="roi-value" id="annualSavings">$0</span>
                                    </div>
                                    <div class="roi-metric highlight">
                                        <span class="roi-label">Payback Period:</span>
                                        <span class="roi-value" id="paybackPeriod">0 years</span>
                                    </div>
                                    <div class="roi-metric">
                                        <span class="roi-label">25-year Savings:</span>
                                        <span class="roi-value" id="lifetimeSavings">$0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="step-actions">
                        <button id="backToStep3" class="btn-secondary">
                            <span class="material-icons">arrow_back</span> Back
                        </button>
                        <button id="restartDesign" class="btn-outline">
                            <span class="material-icons">restart_alt</span> New Design
                        </button>
                        <button id="exportDesign" class="btn-primary">
                            <span class="material-icons">download</span> Export Report
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-content">
                <p>Solar System Sizer PWA v1.0 ‚Ä¢ Works offline ‚Ä¢ 
                    <span id="connectionStatus" class="online">Online</span> ‚Ä¢ 
                    <span id="storageStatus">Storage: 0 projects</span>
                </p>
                <div class="footer-links">
                    <a href="#" id="aboutLink">About</a>
                    <a href="#" id="helpLink">Help</a>
                    <a href="#" id="privacyLink">Privacy</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- JavaScript -->
    <script src="app.js"></script>
    
    <!-- Initialize PWA -->
    <script>
        // Register service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registered:', registration);
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
        
        // Check for PWA install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            const installPrompt = document.getElementById('installPrompt');
            if (installPrompt) {
                installPrompt.style.display = 'block';
                
                document.getElementById('installButton').addEventListener('click', () => {
                    installPrompt.style.display = 'none';
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('User accepted install');
                        } else {
                            console.log('User dismissed install');
                        }
                        deferredPrompt = null;
                    });
                });
                
                document.getElementById('installCancel').addEventListener('click', () => {
                    installPrompt.style.display = 'none';
                });
            }
        });
    </script>
</body>
</html>